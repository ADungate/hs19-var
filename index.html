<html>
  <head>
    <script src="https://aframe.io/releases/0.9.2/aframe.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/4.4.1/d3.min.js"></script>
    <script src="https://cdn.rawgit.com/zcanter/aframe-scatterplot/master/dist/a-scatterplot.min.js"></script>
    <!-- orbit-controls -->
    <script src="//cdn.rawgit.com/tizzle/aframe-orbit-controls-component/master/dist/aframe-orbit-controls-component.min.js"></script>
    <!-- wasd-controls -->
    <script src="//cdn.rawgit.com/donmccurdy/aframe-extras/v3.7.0/dist/aframe-extras.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-entity rotation="0 90 0">
        <a-camera position="-0.06593725135199813, -0.022338808438985724, -0.046025399083270205"></a-camera>
        <a-entity id="circles" >

        </a-entity>
      </a-entity>
      <a-sky></a-sky>

      
    </a-scene>
    <script>

      const getCircles = () => {
        return fetch('curves.json')
          .then(response => response.text())
          .then(text => {
            const coords = JSON.parse(text);
            const circles = [];
            coords.forEach((coord, _) => {
                const circle = `<a-circle position="${coord.x} ${coord.y} ${coord.z}" radius=".001" color="red"></a-circle>`;
                circles.push(circle);
            });  
            return circles;
          });
      }

      const getPairs = async () => {
        const coord_pairs = await fetch('curves.json')
          .then(response => response.text())
          .then(text => {
            const coords = JSON.parse(text);
            let pairs = []
            for (let i = 0; i < coords.length - 2; i++) {
              pairs.push([coords[i], coords[i+1]])
            }
            return pairs;
          });
        return coord_pairs;
      };

      const generateLines = (coord_pairs) => {
        let lines = [];
        coord_pairs.forEach((coord_pair, _) => {
            const start_coord = coord_pair[0];
            const end_coord = coord_pair[1];
            const line = `line="start: ${start_coord.x}, ${start_coord.y}, ${start_coord.z}; ` +
                        `end: ${end_coord.x} ${end_coord.y} ${end_coord.y}; ` +
                        `color: red"`;
            lines.push(line);
        });

        return lines;
      };

      getCircles()
        .then((circles) => {
          const circle_el = document.getElementById("circles");
          circle_el.innerHTML = circles.join(" ");
        });
      
    </script>
  </body>
</html>